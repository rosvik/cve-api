use self::{
    published::{Container, CveMetadata},
    rejected::{RejectedContainer, RejectedMetadata},
};
use serde::{Deserialize, Serialize};

pub mod published;
pub mod rejected;

#[derive(Serialize, Deserialize)]
#[serde(untagged)] // https://serde.rs/enum-representations.html#untagged
#[allow(non_snake_case)]
pub enum CVE {
    Published {
        dataType: String,
        dataVersion: String,
        cveMetadata: CveMetadata,
        containers: Container,
    },
    Rejected {
        dataType: String,
        dataVersion: String,
        cveMetadata: RejectedMetadata,
        containers: RejectedContainer,
    },
}
